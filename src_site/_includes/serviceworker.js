const t=`dGrammatiko-${VERSION}`,e=["/","/index-top.html","/index-bottom.html","/offline.content.html","/offline.html","/manifest.json","/static/fonts/Qw3PZQNVED7rKGKxtqIqX5E-AVSJrOCfjY46_LjQbMZhKSbpUVzEEQ.woff","/static/js/ce-theme-switcher.esm.js"];self.addEventListener("install",(t=>{self.skipWaiting()})),self.addEventListener("activate",(a=>{a.waitUntil(async function(){await clients.claim();const a=await caches.keys();await Promise.all(a.filter((e=>t!==e)).map((t=>caches.delete(t))));const n=await caches.open(t);e.filter((t=>!(t in n))).map((async t=>n.put(t,await fetch(t))))}())})),self.onfetch=async e=>{const{request:a}=e;"GET"===a.method&&("navigate"===a.mode?e.respondWith(async function(e){const n=new URL(a.url),i=await caches.open(t),c=await i.match(a);if(c)return c;if(!(n.pathname in routes)&&"/"!==n.pathname){let t;try{t=await fetch(a)}catch(e){t=await caches.match("/offline.html")}return t&&i.put(a,t.clone()),t}/\/index\.html$/.test(n.pathname)?n.pathname=n.pathname.replace(/index\.html$/,"index.content.html"):n.pathname=/\/$/.test(n.pathname)?`${n.pathname}index.content.html`:`${n.pathname}/index.content.html`,e.waitUntil(async function(t){let e,a;const c=await(await caches.match("/index-top.html")).body,s=await(await caches.match(n)).body,o=await(await caches.match("/index-bottom.html")).body;if("function"==typeof TransformStream){let{writable:t}=new TransformStream;a=[c,s,o].reduce(((e,a,n,i)=>e.then((()=>a.pipeTo(t,{preventClose:n+1!==i.length})))),Promise.resolve())}else a=`${c.text()}${s.text()}${o.text()}`;return e=new Response(a,{headers:{"Content-Type":"text/html; charset=utf-8"}}),await i.put(t.request,e.clone()),e}(e))}(e)):e.respondWith(async function(){const e=await caches.open(t),n=await e.match(a);if(n)return n;let i;try{i=await fetch(a)}catch(t){}return i&&e.put(a,i.clone()),i}()))};
