const t=`dGrammatiko-${VERSION}`,e=["/index-top.html","/index-bottom.html","/offline.content.html","/offline.html","/_assets/tmpl_starchaser/fonts/dgrammatiko.woff2","/_assets/tmpl_starchaser/manifest.json","/_assets/js/toggler.esm.js"];addEventListener("install",a=>{skipWaiting(),a.waitUntil(caches.open(t).then(t=>t.addAll(e)))}),addEventListener("activate",e=>{e.waitUntil(caches.keys().then(e=>Promise.all(e.map(e=>{if(t!==e)return caches.delete(e)}))))});class a{constructor(){let t,e;this.readable=new ReadableStream({start(e){t=e},cancel(t){e.error(t)}}),this.writable=new WritableStream({start(t){e=t},write(e){t.enqueue(e)},close(){t.close()},abort(e){t.error(e)}})}}addEventListener("fetch",e=>{const n=new URL(e.request.url);"GET"===e.request.method&&e.respondWith(async function(){if("function"==typeof WritableStream&&n.origin===location.origin&&routes.includes(n.pathname))return async function(e,n){const s=new URL(n);s.pathname+="index.content.html";const c=[caches.match("/index-top.html"),myFetch(s).catch(()=>caches.match("/offline.content.html")),caches.match("/index-bottom.html")],o=new a;e.waitUntil(async function(){for(const t of c){const e=await t;await e.body.pipeTo(o.writable,{preventClose:!0})}o.writable.getWriter().close()}());const r=await caches.open(t),i=new myResponse(o.readable,{headers:{"Content-Type":"text/html; charset=UTF-8"}});return await r.put(e.request,i.clone()),i}(e,n);const s=await caches.match(e.request);return s||await fetch(e.request).catch(()=>caches.match("/offline.html"))}())});
